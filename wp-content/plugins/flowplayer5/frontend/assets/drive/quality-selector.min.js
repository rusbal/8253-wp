!function($){var forEach=function(col,cb){if("function"==typeof Array.prototype.forEach)return Array.prototype.forEach.call(col,cb);if(!$)throw new Error("jQuery is needed for < IE9");$.each(col,function(i,itm){cb(itm,i)})},on=function(el,ev,slctr,hndlr){return"object"==typeof flowplayer.bean?flowplayer.bean.on(el,ev,slctr,hndlr):el.on(ev,slctr,hndlr)},find=function(el,slctr){return"function"==typeof flowplayer.Sizzle?flowplayer.Sizzle(slctr,el):$(el).find(slctr)},d=function(el,atr){return"function"==typeof el.data?el.data(atr):el.getAttribute("data-"+atr.replace(/([A-Z])/g,function($1){return"-"+$1.toLowerCase()}))},createElement=function(tagName,attrs,innerText){return flowplayer.common?flowplayer.common.createElement(tagName,attrs,innerText):$("<"+tagName+"/>").attr(attrs).text(innerText)[0]},remove=function(el){return flowplayer.common?flowplayer.common.removeNode(el):$(el).remove()},removeClass=function(el,cls){return flowplayer.common?flowplayer.common.removeClass(el,cls):$(el).removeClass(cls)},addClass=function(el,cls){return flowplayer.common?flowplayer.common.addClass(el,cls):$(el).addClass(cls)};flowplayer(function(api,root){if(!api.pluginQualitySelectorEnabled){api.pluginQualitySelectorEnabled=!0;var explicitSrc=!1,canPlay=function(type){var videoTag=document.createElement("video");return!!videoTag.canPlayType(type).replace("no","")};if(!flowplayer.support.video||flowplayer.support.inlineVideo&&!canPlay("application/x-mpegurl")){var getQualityFromSrc=function(src,qualities){var m=/-(\d+p)(\.(mp4|webm))?$/.exec(src);if(m&&-1!==qualities.indexOf(m[1]))return m[1]};if(api.conf.qualities){api.conf.qualities=api.conf.qualities.split(","),on(root,"click",".fp-quality-selector li",function(){if(!/\bactive\b/.test(this.className)){var src,currentTime=api.finished?0:api.video.time,quality=$(this).data("quality"),currentQuality=Math.min(api.video.height,api.video.width)+"p",isDefaultQuality=quality===api.conf.defaultQuality;src=currentQuality===api.conf.defaultQuality?api.video.src.replace(/(.+?)((\.(mp4|webm)$|$))/,"$1-"+quality+"$2"):api.video.src.replace(/(-\d+p)?((\.(mp4|webm)$|$))/,isDefaultQuality?"$2":"-"+quality+"$2"),api.conf.rtmp&&(src=src.replace(api.conf.rtmp,"").replace(/^\//,"")),api.quality=quality,explicitSrc=!0,api.load(src,function(){explicitSrc=!1,api.finished=!1,currentTime&&!api.live&&api.seek(currentTime,function(){api.resume()})})}});var findOptimalQuality=function(previousQuality,newQualities){var ret,a=parseInt(previousQuality,0);return forEach(newQualities,function(quality,i){i!=newQualities.length-1||ret||(ret=quality),parseInt(quality)<=a&&parseInt(newQualities[i+1])>a&&(ret=quality)}),ret};api.bind("load",function(ev,api,video){if(api.quality){var playlistItemEl=find(root,'.fp-playlist [data-index="'+video.index+'"]')[0],qualities=api.conf.qualities=api.conf.playlist.length?api.conf.playlist[video.index].qualities||(d(playlistItemEl,"qualities")?d(playlistItemEl,"qualities").split(","):api.conf.qualities):api.conf.qualities,desiredQuality=findOptimalQuality(api.quality,qualities),isDefaultQuality=api.conf.playlist.length?desiredQuality==(api.conf.playlist[video.index].defaultQuality||(d(playlistItemEl,"defaultQuality")?d(playlistItemEl,"defaultQuality"):api.conf.defaultQuality)):desiredQuality==api.conf.defaultQuality,src=video.src.replace(/(-\d+p)?\.(mp4|webm)$/,isDefaultQuality?".$2":"-"+desiredQuality+".$2");explicitSrc||video.src===src||(ev.preventDefault(),api.loading=!1,api.load(src))}});var removeAllQualityClasses=function(){forEach(api.conf.qualities,function(quality){removeClass(root,"quality-"+quality)})};api.bind("ready",function(ev,api,video){var quality=getQualityFromSrc(video.src,api.conf.qualities)||Math.min(video.height,video.width)+"p";removeAllQualityClasses(),api.quality=quality,addClass(root,"quality-"+quality);var ui=find(root,".fp-ui")[0];if(remove(find(ui,".fp-quality-selector")[0]),!(api.conf.qualities.length<2)){var selector=createElement("ul",{"class":"fp-quality-selector"});ui.appendChild(selector),forEach(api.conf.qualities,function(q,i){selector.appendChild(createElement("li",{"data-quality":q,"class":q==quality?"active":""},q))})}}),api.bind("unload",function(){removeAllQualityClasses(),remove(find(root,".fp-quality-selector")[0])})}}}})}(window.jQuery);